<?xml version="1.0"?>

<launch>
      <arg name="robot_type" default="$(env ROBOT_TYPE)" doc="Robot type: [a1, aliengo, go1, laikago]" />
      <arg name="ns" default="$(env ROBOT_NAME)"/>    
      <arg name="x" default="0" />
      <arg name="y" default="0" />

      <group ns="$(arg ns)">

            <rosparam file="$(find legged_gazebo)/config/default.yaml" command="load" />
            
            <param name="legged_robot_description"
                  command="$(find xacro)/xacro $(find custom_description)/urdf/robot.xacro 
                  ns:=$(arg ns) robot_type:=$(arg robot_type) sim:=true"/>

            <node name="generate_urdf" pkg="legged_common" type="generate_urdf.sh" output="screen"
                  args="$(find custom_description)/urdf/robot.xacro $(arg robot_type)" />
            
            <node name="spawn_urdf" pkg="gazebo_ros" type="spawn_model" clear_params="true"
                  args="-z 0.5 -x $(arg x) -y $(arg y) -param legged_robot_description -urdf -model $(arg ns)" output="screen" />

            <param name="robot_description" textfile="/tmp/legged_control/$(arg robot_type).urdf" />
            <param name="urdfFile" value="/tmp/legged_control/$(arg robot_type).urdf" />
            <param name="taskFile" value="$(find legged_controllers)/config/$(arg robot_type)/task.info" />
            <param name="referenceFile" value="$(find legged_controllers)/config/$(arg robot_type)/reference.info" />
            <param name="gaitCommandFile" value="$(find legged_controllers)/config/$(arg robot_type)/gait.info" />

            <rosparam file="$(find multi_controllers)/config/controllers.yaml" command="load" />

            <node name="controller_loader" pkg="controller_manager" type="controller_manager"
                  output="screen"
                  args="load
                  controllers/multi_legged_controller" />

            <node pkg="legged_deployment" type="gait_command_node" name="gait_command_node"
                  output="screen" />

            <node pkg="legged_deployment" type="CmdPublisher" name="CmdPublisher"
                  output="screen"/>
       </group>     


</launch>